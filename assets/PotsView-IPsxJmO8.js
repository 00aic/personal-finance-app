import{c as E,a as F,b as K,u as O,B as q,F as M}from"./index.esm-Capl0ve9.js";import{C as Q}from"./colors-BNY3Qihl.js";import{S as X}from"./SelectPicker-BKE-Yk6y.js";import{B as L,C as Z,D as ee}from"./BaseInput-BbJYscEQ.js";import{d as N,p as k,q as R,c as f,r as _,w as j,s as z,v as V,u as r,b as l,f as p,x as I,t as w,i as C,j as S,a as U,n as D,o as te,F as ae,e as oe}from"./index-C032iH88.js";import{g as le,d as ne,a as se,u as de,b as re}from"./pots-4Ew2T_xh.js";import{f as T}from"./useImageUrl-C2JENkPK.js";import"./illustration-authentication-BmoVJKBC.js";import"./config-DsdTllfp.js";const ue={class:"form"},me=N({__name:"UpsertPot",props:k({data:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:k(["upset"],["update:modelValue"]),setup(b,{emit:e}){const m=R(b,"modelValue"),t=b,y=f(()=>{var s;return(s=t.data)!=null&&s.name?"Edit Pot":"Add New Pot"}),P=f(()=>{var s;return(s=t==null?void 0:t.data)!=null&&s.name?"If your saving targets change, feel free to update your pots.":"Create a pot to set savings targets. These can help keep you on track as you save for special purchases."}),A=f(()=>{var s;return(s=t==null?void 0:t.data)!=null&&s.name?"Save Changes":"Add Pot"}),c=_({id:"",name:"",target:0,theme:"#277C78"});j(()=>t.data,s=>{s&&(c.value={...s})},{immediate:!0});const o=E({name:K().max(30).required("Can't be empty"),target:F().transform((s,n)=>n===""?void 0:s).typeError("Must be number").required("Can't be empty")}),{handleSubmit:g}=O({validationSchema:o}),h=e,$=g(()=>{h("upset",c.value),m.value=!1});return(s,n)=>(C(),z(r(q),{modelValue:m.value,"onUpdate:modelValue":n[4]||(n[4]=a=>m.value=a),title:y.value,tip:P.value},{footer:V(()=>[l("button",{class:"button",onClick:n[3]||(n[3]=(...a)=>r($)&&r($)(...a))},w(A.value),1)]),default:V(()=>[l("form",ue,[p(r(M),{modelValue:c.value.name,"onUpdate:modelValue":n[0]||(n[0]=a=>c.value.name=a),name:"name",label:"Pot Name",placeholder:"e.g. Rainy Days"},null,8,["modelValue"]),p(r(M),{modelValue:c.value.target,"onUpdate:modelValue":n[1]||(n[1]=a=>c.value.target=a),name:"target",label:"Target"},{default:V(({field:a})=>[p(r(L),I(a,{"model-value":a.value,prefix:"$",placeholder:"e.g.2000"}),null,16,["model-value"])]),_:1},8,["modelValue"]),p(r(M),{modelValue:c.value.theme,"onUpdate:modelValue":n[2]||(n[2]=a=>c.value.theme=a),name:"theme",label:"Theme"},{default:V(({field:a})=>[p(r(X),I(a,{"model-value":a.value,options:r(Q),class:"form__select",width:"100%"}),null,16,["model-value","options"])]),_:1},8,["modelValue"])])]),_:1},8,["modelValue","title","tip"]))}}),W=S(me,[["__scopeId","data-v-129269f4"]]),ie={class:"total"},ce={class:"total__saved"},ve={class:"total__saved-label"},pe={class:"total__saved-value"},ye={class:"progress"},ge={class:"target"},fe={class:"target__total"},he=N({__name:"AmountChart",props:{type:{default:"dynamic"},mode:{default:"add"},data:{},dynamicAmount:{default:0}},setup(b){const e=b,m=e.type==="dynamic"?"New Amount":"Total Saved",t=o=>T(o,{currency:"USD"}),y=f(()=>{if(e.type==="dynamic")if(e.mode==="add"){const o=Math.min((e.data.total??0)/e.data.target*100,100),g=Math.min(e.dynamicAmount/e.data.target*100,100);return{...e.data,progressPercentage:o,dynamicProgressPercentage:g,totalPercentage:Math.min(o+g,100),totalAmount:(e.data.total??0)+e.dynamicAmount}}else{const o=Math.max(((e.data.total??0)-e.dynamicAmount)/e.data.target*100,0),g=Math.min(e.dynamicAmount/e.data.target*100,100);return{...e.data,progressPercentage:o,dynamicProgressPercentage:g,totalPercentage:o,totalAmount:(e.data.total??0)-e.dynamicAmount}}else{const o=Math.min((e.data.total??0)/e.data.target*100,100);return{...e.data,progressPercentage:o,dynamicProgressPercentage:0,totalPercentage:o,totalAmount:e.data.total??0}}}),P=f(()=>{const o={width:`${y.value.progressPercentage}%`};return e.type==="dynamic"?o:{...o,backgroundColor:e.data.theme}}),A=f(()=>({width:`${y.value.dynamicProgressPercentage}%`,backgroundColor:e.mode==="add"?"var(--color-green)":"var(--color-red)"})),c=f(()=>e.type==="dynamic"?{color:e.mode==="add"?"var(--color-green)":"var(--color-red)"}:{color:"var(--color-grey-500)"});return(o,g)=>(C(),U("div",ie,[l("div",ce,[l("div",ve,w(r(m)),1),l("div",pe,w(t(y.value.totalAmount)),1)]),l("div",ye,[l("div",{class:"progress__fill",style:D(P.value)},null,4),l("div",{class:"progress__dynamic",style:D(A.value)},null,4)]),l("div",ge,[l("div",{class:"target__percentage",style:D(c.value)},w(r(T)(y.value.totalPercentage,{style:"decimal"}))+"% ",5),l("div",fe,"Target of "+w(t(y.value.target)),1)])]))}}),G=S(he,[["__scopeId","data-v-4e624ebd"]]),_e={class:"form"},be=N({__name:"UpsertMoney",props:k({mode:{default:"add"},data:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:k(["upset"],["update:modelValue"]),setup(b,{emit:e}){const m=R(b,"modelValue"),t=b,y=f(()=>t.mode==="add"?`Add to '${t.data.name}'`:`Withdraw from '${t.data.name}'`),P=f(()=>t.mode==="add"?"Add money to your pot to keep it separate from your main balance. As soon as you add this money, it will be deducted from your current balance.":"Withdraw from your pot to put money back in your main balance. This will reduce the amount you have in this pot."),A=f(()=>t.mode==="add"?"Amount to Add":"Amount to Withdraw"),c=f(()=>t.mode==="add"?"Confirm Addition":"Confirm Withdrawal"),o=_({dynamicAmount:0}),g=f(()=>{const n=t.mode==="add"?Number(t.data.target-(t.data.total??0)):Number(t.data.total??0),a=t.mode==="add"?`Must be less than ${n}(${t.data.target} - ${t.data.total??0} )`:`Must be less than ${n}`;return E({dynamicAmount:F().transform((v,x)=>x===""?void 0:v).typeError("Must be number").max(n,a).min(0,"Must be more than 0").required("Can't be empty")})}),{handleSubmit:h}=O({validationSchema:g}),$=e,s=h(()=>{const n=t.mode==="add"?Number(t.data.total??0)+Number(o.value.dynamicAmount):Number(t.data.total??0)-Number(o.value.dynamicAmount);$("upset",Number(n)),m.value=!1});return j(()=>t.mode,()=>{o.value.dynamicAmount=0}),(n,a)=>(C(),z(r(q),{modelValue:m.value,"onUpdate:modelValue":a[2]||(a[2]=v=>m.value=v),title:y.value,tip:P.value},{footer:V(()=>[l("button",{class:"button",onClick:a[1]||(a[1]=(...v)=>r(s)&&r(s)(...v))},w(c.value),1)]),default:V(()=>[l("form",_e,[p(G,{mode:n.mode,data:n.data,"dynamic-amount":Number(o.value.dynamicAmount)},null,8,["mode","data","dynamic-amount"]),p(r(M),{modelValue:o.value.dynamicAmount,"onUpdate:modelValue":a[0]||(a[0]=v=>o.value.dynamicAmount=v),name:"dynamicAmount",label:A.value},{default:V(({field:v})=>[p(r(L),I(v,{"model-value":v.value,prefix:"$",placeholder:"e.g.2000"}),null,16,["model-value"])]),_:1},8,["modelValue","label"])])]),_:1},8,["modelValue","title","tip"]))}}),Pe=S(be,[["__scopeId","data-v-c05028f3"]]),Ae={class:"pots common-layout-page"},Ve={class:"details"},we={class:"header"},$e={class:"header__title"},Ce={class:"header__title-name"},Me={class:"button"},Ue=["onClick"],De=["onClick"],ke=N({__name:"PotsView",setup(b){const e=_([]),m=async()=>{e.value=(await le()).data};te(async()=>{await m()});const t=f(()=>e.value.map(d=>({...d,progressPercentage:Math.min((d.total??0)/d.target*100,100)}))),y=_(!1),P=()=>{y.value=!0},A=async d=>{await se(d),await m()},c=[{label:"Edit Pot",value:"edit"},{label:"Delete Pot",value:"delete"}],o=_(!1),g=_(!1),h=_({id:"",name:"",target:0,theme:""}),$=(d,u)=>{h.value=u,d==="delete"?o.value=!0:g.value=!0},s=async d=>{await ne(d),await m()},n=async d=>{await de(d),await m()},a=_(!1),v=_("add"),x=d=>{h.value=d,v.value="add",a.value=!0},Y=d=>{h.value=d,v.value="withdraw",a.value=!0},H=async d=>{await re(h.value.id,d),await m()};return(d,u)=>(C(),U("div",Ae,[l("div",{class:"head"},[u[5]||(u[5]=l("header",{class:"header"},"Pots",-1)),l("button",{class:"add",onClick:P},"+Add New Pot")]),p(W,{modelValue:y.value,"onUpdate:modelValue":u[0]||(u[0]=i=>y.value=i),onUpset:A},null,8,["modelValue"]),l("div",Ve,[(C(!0),U(ae,null,oe(t.value,(i,J)=>(C(),U("div",{class:"item",key:J,style:D({"--color-budget-border":i.theme})},[l("div",we,[l("div",$e,[u[6]||(u[6]=l("div",{class:"header__title-circle"},null,-1)),l("div",Ce,w(i.name),1)]),p(r(ee),{options:c,onSelect:B=>$(B,i)},null,8,["onSelect"])]),p(G,{type:"static",data:i},null,8,["data"]),l("div",Me,[l("button",{onClick:B=>x(i)},"+Add Money",8,Ue),l("button",{onClick:B=>Y(i)},"Withdraw",8,De)])],4))),128)),p(r(Z),{modelValue:o.value,"onUpdate:modelValue":u[1]||(u[1]=i=>o.value=i),title:`Delete '${h.value.name}'?`,message:"Are you sure you want to delete this pot? This action cannot be reversed, and all the data inside it will be removed forever.","confirm-text":"Yes, Confirm Deletion","cancel-text":"No, Go Back",onConfirm:u[2]||(u[2]=i=>s(h.value.id))},null,8,["modelValue","title"]),p(W,{data:h.value,modelValue:g.value,"onUpdate:modelValue":u[3]||(u[3]=i=>g.value=i),onUpset:n},null,8,["data","modelValue"]),p(Pe,{modelValue:a.value,"onUpdate:modelValue":u[4]||(u[4]=i=>a.value=i),mode:v.value,data:h.value,onUpset:H},null,8,["modelValue","mode","data"])])]))}}),Oe=S(ke,[["__scopeId","data-v-1b3b1158"]]);export{Oe as default};
