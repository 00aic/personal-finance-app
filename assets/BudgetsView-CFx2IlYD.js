import{_ as j,u as z,f as H}from"./useImageUrl-Bnx17IBW.js";import{u as J,B as K,a as Q,d as X,b as Z,c as ee}from"./useBudgetsChart-CesfLgsO.js";import{f as te}from"./dateUtils-qMqWlCi5.js";import{d as L,p as O,q as ae,c as b,r as f,w as se,s as le,v as y,u as o,b as e,f as m,x as T,t as r,i as v,j as R,o as oe,a as p,F as N,e as I,n as P,g as de}from"./index-CDsun8ib.js";import{B as ne,C as ie,D as ue}from"./BaseInput-DqEMKQsa.js";import{c as re,a as me,u as ce,B as ve,F as M}from"./index.esm-S9F6OBOS.js";import{S as E}from"./SelectPicker-2nO18_9z.js";import{a as _e}from"./categories-YDGcINYU.js";import{C as ge}from"./colors-BNY3Qihl.js";import"./illustration-authentication-BmoVJKBC.js";import"./config-DsdTllfp.js";const pe={class:"form"},he=L({__name:"UpsertBudget",props:O({data:{},usedTheme:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:O(["upsert"],["update:modelValue"]),setup(w,{emit:x}){const c=ae(w,"modelValue"),n=w,S=b(()=>{var d;return(d=n==null?void 0:n.data)!=null&&d.category?"Edit Budget":"Add New Budget"}),C=b(()=>{var d;return(d=n==null?void 0:n.data)!=null&&d.category?"As your budgets change, feel free to update your spending limits.":"Choose a category to set a spending budget. These categories can help you monitor spending."}),D=b(()=>{var d;return(d=n==null?void 0:n.data)!=null&&d.category?"Save Changes":"Add Budget"}),u=f({category:"Entertainment",theme:"#277C78",maximum:0});se(()=>n.data,d=>{d&&(u.value={...d})},{immediate:!0});const _=re({maximum:me().transform((d,i)=>i===""?void 0:d).typeError("Must be number").required("Can't be empty")}),{handleSubmit:U}=ce({validationSchema:_}),B=x,h=U(()=>{u.value.maximum=Number(u.value.maximum),B("upsert",u.value),c.value=!1});return(d,i)=>(v(),le(o(ve),{modelValue:c.value,"onUpdate:modelValue":i[4]||(i[4]=s=>c.value=s),title:S.value,tip:C.value},{footer:y(()=>[e("button",{class:"button",onClick:i[3]||(i[3]=(...s)=>o(h)&&o(h)(...s))},r(D.value),1)]),default:y(()=>[e("form",pe,[m(o(M),{modelValue:u.value.category,"onUpdate:modelValue":i[0]||(i[0]=s=>u.value.category=s),name:"category",label:"Budget Category"},{default:y(({field:s})=>[m(o(E),T(s,{"model-value":s.value,options:o(_e),class:"form__select",width:"100%"}),null,16,["model-value","options"])]),_:1},8,["modelValue"]),m(o(M),{modelValue:u.value.maximum,"onUpdate:modelValue":i[1]||(i[1]=s=>u.value.maximum=s),name:"maximum",label:"Maximum Spend"},{default:y(({field:s})=>[m(o(ne),T(s,{"model-value":s.value,prefix:"$",placeholder:"e.g.2000"}),null,16,["model-value"])]),_:1},8,["modelValue"]),m(o(M),{modelValue:u.value.theme,"onUpdate:modelValue":i[2]||(i[2]=s=>u.value.theme=s),name:"theme",label:"Theme"},{default:y(({field:s})=>[m(o(E),T(s,{"model-value":s.value,options:o(ge),class:"form__select",width:"100%",type:"color","used-values":d.usedTheme}),null,16,["model-value","options","used-values"])]),_:1},8,["modelValue"])])]),_:1},8,["modelValue","title","tip"]))}}),F=R(he,[["__scopeId","data-v-114d4a0b"]]),fe={class:"budgets common-layout-page"},ye={class:"content"},be={class:"summary"},Be={class:"spending"},Ve={class:"sp-header__details"},we={class:"sp-item__label"},xe={class:"sp-item__value"},Se={class:"sp-item__value-spent"},Ce={class:"sp-item__value-total"},De={class:"body"},Ue={class:"header"},Ae={class:"header__title"},ke={class:"header__title-name"},$e={class:"amount"},Te={class:"maximum"},Ne={class:"progress"},Ie={class:"detail"},Pe={class:"detail__spent"},Me={class:"detail__spent-value"},Oe={class:"detail__remaining"},Ee={class:"detail__remaining-value"},Fe={class:"latest"},Le={class:"l-header"},Re=["onClick"],qe={class:"l-items"},We={class:"l-item__user"},Ge={class:"l-item__user-avatar"},Ye=["src"],je={class:"l-item__user-name"},ze={class:"l-item__content"},He={class:"l-item__content-value"},Je={class:"l-item__content-time"},Ke=L({__name:"BudgetsView",setup(w){const x=de(),c=f([]),n=async()=>{c.value=(await Q()).data};oe(async()=>{await n()});const{chartData:S,chartLimit:C,chartSpent:D}=J(c),u=b(()=>c.value.map(l=>{const t=l.maximum-(l.spent??0);return{...l,remaining:t<0?0:t,progressPercentage:Math.min((l.spent??0)/l.maximum*100,100)}})),_=l=>H(l,{currency:"USD"}),U=l=>{x.push({name:"Transactions",query:{category:l}})},B=b(()=>c.value.map(l=>l.theme)),h=f(!1),d=()=>{h.value=!0},i=async l=>{await Z(l),await n()},s=[{label:"Edit Pot",value:"edit"},{label:"Delete Pot",value:"delete"}],A=f(!1),k=f(!1),V=f({category:"all",maximum:0,theme:""}),q=(l,t)=>{V.value=t,l==="delete"?A.value=!0:k.value=!0},W=async l=>{await X(l),await n()},G=async l=>{await ee(l),await n()};return(l,t)=>(v(),p("div",fe,[e("div",{class:"head"},[t[4]||(t[4]=e("header",{class:"header"},"Budgets",-1)),e("button",{class:"add",onClick:d},"+Add New Budget")]),m(F,{"used-theme":B.value,modelValue:h.value,"onUpdate:modelValue":t[0]||(t[0]=a=>h.value=a),onUpsert:i},null,8,["used-theme","modelValue"]),e("div",ye,[e("div",be,[m(o(K),{data:o(S),limit:o(C),spent:o(D)},null,8,["data","limit","spent"]),e("div",Be,[t[5]||(t[5]=e("div",{class:"sp-header"},"Spending Summary",-1)),e("div",Ve,[(v(!0),p(N,null,I(u.value,(a,$)=>(v(),p("div",{class:"sp-item",key:`budget-${$}`,style:P({"--color-budget-border":a.theme})},[e("div",we,r(a.category),1),e("div",xe,[e("span",Se,r(_(a.spent??0)),1),e("span",Ce,"of "+r(_(a.maximum)),1)])],4))),128))])])]),e("div",De,[(v(!0),p(N,null,I(u.value,(a,$)=>(v(),p("div",{class:"details",key:$,style:P({"--color-budget-progress":a.theme})},[e("div",Ue,[e("div",Ae,[t[6]||(t[6]=e("div",{class:"header__title-circle"},null,-1)),e("div",ke,r(a.category),1)]),m(o(ue),{options:s,onSelect:g=>q(g,a)},null,8,["onSelect"])]),e("div",$e,[e("div",Te,"Maximum of $"+r(a.maximum),1),e("div",Ne,[e("div",{class:"progress__fill",style:P({width:`${a.progressPercentage}%`})},null,4)]),e("div",Ie,[e("div",Pe,[t[7]||(t[7]=e("div",{class:"detail__spent-label"},"Spent",-1)),e("div",Me,r(_(a.spent??0)),1)]),e("div",Oe,[t[8]||(t[8]=e("div",{class:"detail__remaining-label"},"Remaining",-1)),e("div",Ee,r(_(a.remaining)),1)])])]),e("div",Fe,[e("div",Le,[t[10]||(t[10]=e("div",{class:"l-header__title"},"Latest Spending",-1)),e("div",{class:"l-header__action",onClick:g=>U(a.category)},t[9]||(t[9]=[e("div",null,"See All",-1),e("div",null,[e("img",{src:j,alt:"more"})],-1)]),8,Re)]),e("div",qe,[(v(!0),p(N,null,I(a.transactions,(g,Y)=>(v(),p("div",{class:"l-item",key:`trac${Y}`},[e("div",We,[e("div",Ge,[e("img",{src:o(z)(g.avatar).value,alt:"avatar"},null,8,Ye)]),e("div",je,r(g.name),1)]),e("div",ze,[e("div",He,r(_(g.amount)),1),e("div",Je,r(o(te)(g.date)),1)])]))),128))])])],4))),128))])]),m(o(ie),{modelValue:A.value,"onUpdate:modelValue":t[1]||(t[1]=a=>A.value=a),title:`Delete '${V.value.category}'?`,message:"Are you sure you want to delete this budget? This action cannot be reversed, and all the data inside it will be removed forever.","confirm-text":"Yes, Confirm Deletion","cancel-text":"No, Go Back",onConfirm:t[2]||(t[2]=a=>W(V.value.category))},null,8,["modelValue","title"]),m(F,{"used-theme":B.value,data:V.value,modelValue:k.value,"onUpdate:modelValue":t[3]||(t[3]=a=>k.value=a),onUpsert:G},null,8,["used-theme","data","modelValue"])]))}}),it=R(Ke,[["__scopeId","data-v-dbc05a21"]]);export{it as default};
